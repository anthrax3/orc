<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>ORC Tutorial: Using the Local Bridge</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<script src="scripts/highlight.min.js"></script>

	<link type="text/css" rel="stylesheet" href="styles/site.granax.css">

</head>

<body>

<div class="navbar navbar-default navbar-fixed-top ">
<div class="container">
	<div class="navbar-header">
		<a class="navbar-brand" style="background-image:url(img/orc.png)"  href="index.html">ORC</a>
		<button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#topNavigation">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
        </button>
	</div>
	<div class="navbar-collapse collapse" id="topNavigation">
		<ul class="nav navbar-nav">
			
			<li class="dropdown">
				<a href="modules.list.html" class="dropdown-toggle" data-toggle="dropdown">Modules<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="module-orc.html">orc</a></li><li><a href="module-orc_constants.html">orc/constants</a></li><li><a href="module-orc_utils.html">orc/utils</a></li><li><a href="module-orc_version.html">orc/version</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="Audit.html">Audit</a></li><li><a href="Bridge.html">Bridge</a></li><li><a href="Database.html">Database</a></li><li><a href="Database.AuditReport.html">Database.AuditReport</a></li><li><a href="Database.NetworkBlob.html">Database.NetworkBlob</a></li><li><a href="Database.ObjectPointer.html">Database.ObjectPointer</a></li><li><a href="Database.PeerProfile.html">Database.PeerProfile</a></li><li><a href="Database.ShardContract.html">Database.ShardContract</a></li><li><a href="Directory.html">Directory</a></li><li><a href="KadStorageAdapter.html">KadStorageAdapter</a></li><li><a href="Node.html">Node</a></li><li><a href="Proof.html">Proof</a></li><li><a href="Rules.html">Rules</a></li><li><a href="Server.html">Server</a></li><li><a href="Shards.html">Shards</a></li><li><a href="Transport.html">Transport</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="events.list.html" class="dropdown-toggle" data-toggle="dropdown">Events<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="Server.html#event:error">Server#event:error</a></li><li><a href="Server.html#event:shardDownloaded">Server#event:shardDownloaded</a></li><li><a href="Server.html#event:shardUploaded">Server#event:shardUploaded</a></li><li><a href="Transport.html#event:download">Transport#event:download</a></li><li><a href="Transport.html#event:upload">Transport#event:upload</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="tutorials.list.html" class="dropdown-toggle" data-toggle="dropdown">Tutorials<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="tutorial-config.html">Configuration Guide</a></li><li><a href="tutorial-control.html">Using the Control Port</a></li><li><a href="tutorial-directory_.html">Using the Local Directory</a></li><li><a href="tutorial-install.html">Manual Installation</a></li><li><a href="tutorial-transfers.html">Using the Local Bridge</a></li><li><a href="tutorial-usage.html">Using the Node.js Library</a></li>
				</ul>
			</li>
			
		</ul>
		<div class="col-sm-3 col-md-4">
            <form class="navbar-form" role="search">
                <div class="input-group">
                    <input type="text" class="form-control" placeholder="Search" name="q" id="search-input">
                    <div class="input-group-btn">
                        <button class="btn btn-primary" id="search-submit"><i class="glyphicon glyphicon-search"></i></button>
                    </div>
                </div>
            </form>
        </div>
	</div>

</div>
</div>


<div class="container" id="toc-content">
<div class="row">

	
	<div class="col-md-12">
	
		<div id="main">
			<section class="tutorial-section">

<header>
    

    <h2>Using the Local Bridge</h2>
</header>

<article>
    <p>This guide will show you how to configure your node to expose a simple REST 
API that applications can use to upload, download, delete, and list objects 
you have stored in the network.</p>
<blockquote>
<p>Make sure you've read over the <a href="tutorial-config.html">Configuration Guide</a> and understand the 
the security implications for various settings related the the local bridge.</p>
</blockquote>
<p>For the purposes of brevity for this guide, we are going to assume the 
following configuration scheme and will use <code>curl</code> for the examples:</p>
<pre class="prettyprint source"><code>BridgeEnabled = 1
BridgeHostname = 127.0.0.1
BridgePort = 4445
BridgeUseSSL = 0
BridgeAuthenticationEnabled = 0</code></pre><h3><code>GET /</code></h3><p>Retreive a JSON list of your objects stored in the network and managed by this 
node. Each item returned in the list contains metadata regarding the type, 
size, name, hash, location of shards, and more.</p>
<pre class="prettyprint source"><code>$ curl http://127.0.0.1:4445 | jq
[
  {
    &quot;encoding&quot;: &quot;7bit&quot;,
    &quot;size&quot;: 43472,
    &quot;ecpub&quot;: &quot;02dc3937fd97fc26a54ad976c4cda37eb513d9a86debca18dd6f2e83717c9227d3&quot;,
    &quot;hash&quot;: &quot;24081ee6fd4a5395a44597e36c5314b1308a197137db45e08d6d86aa070fbe84&quot;,
    &quot;status&quot;: &quot;finished&quot;,
    &quot;policies&quot;: [
      &quot;::RETRIEVE&quot;
    ],
    &quot;shards&quot;: [
      {
        &quot;size&quot;: 21744,
        &quot;hash&quot;: &quot;e1eede74c9512f1994b18eac6465a0b471201548&quot;,
        &quot;service&quot;: [
          &quot;ccfbab389c9c547badb708021c0eaad4d9ec87ed&quot;,
          {
            &quot;agent&quot;: &quot;orc-8.1.1-beta5/linux&quot;,
            &quot;index&quot;: 2,
            &quot;xpub&quot;: &quot;xpub6BRiU17o5vnTq8sGX2DgjBoU1ozBZnBDiW4avCwoFUzcYtrHMKxs8BjdS3qt6AAv42KDE2B4D2q3Fj3cYuzuCFoDijnQKJYvoMLJV2rEGVL&quot;,
            &quot;port&quot;: 443,
            &quot;protocol&quot;: &quot;https:&quot;,
            &quot;hostname&quot;: &quot;orcwfkilxjxo63mr.onion&quot;
          }
        ]
      },
      {
        &quot;size&quot;: 21744,
        &quot;hash&quot;: &quot;0a2f5a2a47ffe851403bfb4dc56be9b09392d182&quot;,
        &quot;service&quot;: [
          &quot;681069cc9dc643999be1031a8740d2a341939262&quot;,
          {
            &quot;agent&quot;: &quot;orc-8.1.1-beta6/linux&quot;,
            &quot;index&quot;: 0,
            &quot;xpub&quot;: &quot;xpub6ARoW5DJo4xBbob8Gr3HReVU3qqJQpBRqBR2SDJkaYq5eJGL17yhGijXzkmobJe3f5nPHyZrohWR5txhCUjiXvhfCR3v2vmc7MuAYCcrTbt&quot;,
            &quot;port&quot;: 443,
            &quot;protocol&quot;: &quot;https:&quot;,
            &quot;hostname&quot;: &quot;puiq7u4bw6lroev5.onion&quot;
          }
        ]
      },
      {
        &quot;size&quot;: 21744,
        &quot;hash&quot;: &quot;4c38ad2a132b8d683abcc73f2eddf9d2700ad5d7&quot;,
        &quot;service&quot;: [
          &quot;1723b631252fc5f50ba43a8cfd2f38cba0daf44c&quot;,
          {
            &quot;agent&quot;: &quot;orc-8.1.1-beta1/linux&quot;,
            &quot;index&quot;: 0,
            &quot;xpub&quot;: &quot;xpub6AxEbAJY7bV33paGh9wbGgDh7q6T67LQKBEbo93vxez4zPF4sQQnNHK55suXWk4ViZYsjy1jwdUtuuWosUWAyEQMeqXmJKhbbuZnAcGLQRF&quot;,
            &quot;port&quot;: 443,
            &quot;protocol&quot;: &quot;https:&quot;,
            &quot;hostname&quot;: &quot;wifniq3h3gqm2b2w.onion&quot;
          }
        ]
      }
    ],
    &quot;mimetype&quot;: &quot;image/png&quot;,
    &quot;name&quot;: &quot;avatar.png&quot;,
    &quot;id&quot;: &quot;59d2627ebb28977b0e6ab841&quot;
  }
]</code></pre><h3><code>POST /</code></h3><p>You can upload a file to the network my sending a multipart/form-upload request 
to <code>POST /</code>. This works the same as if using a <code>&lt;input type=&quot;file&quot;/&gt;</code> on a web
page. You can also add <code>policy</code> fields to specify access policies as defined in 
<a href="https://github.com/orcproject/imps/blob/master/imp-0010.md">IMP-0010</a>.</p>
<pre class="prettyprint source"><code>$ curl -F &quot;file=@avatar.png;type=image/png;&quot; -F &quot;policy=::RETRIEVE&quot; http://127.0.0.1:5445 | jq</code></pre><p>Once the object is completely distributed, the metadata will be returned. You 
can check on the status of an object while the request is pending by listing 
the objects using <code>GET /</code>. Statuses may be <em>finished</em>, <em>queued</em>, or <em>failed</em>.</p>
<h3><code>GET /{id}</code></h3><p>You can download a file from the network knowing only the object's ID in the 
local bridge service. The appropriate headers for content type are sent to 
enable browsers and other applications to display the downloaded object.</p>
<pre class="prettyprint source"><code>$ curl http://127.0.0.1:4445/59d2627ebb28977b0e6ab841 >> avatar.png</code></pre><blockquote>
<p>Note that decryption is performed by the local bridge service, so it is very 
important to configure your bridge to use authentication if exposing 
as an onion service and SSL if exposing over the clearnet.</p>
</blockquote>
<h3><code>GET /{id}/magnet</code></h3><p>If you supplied an appropriate access <code>policy</code> field on upload, you can share a 
magnet link with others to fetch the object pointer.</p>
<pre class="prettyprint source"><code>$ curl http://127.0.0.1:4445/59d2627ebb28977b0e6ab841/magnet | jq
{
  &quot;href&quot;: &quot;magnet:?xt=urn:orc:a3cd254243fc02579384d75cba2588a6c9e850d1&xs=43472&dn=avatar.png&x.ecprv=2daade3b5a4af3641e22cb0317cadf3115bc4b800e0eceaa1a4568c53e60911b&x.pword=17300e194a57251388e98b104411b2004223fe7a&quot;
}</code></pre><p>This will return a magnet link that contains the hash of the encrypted pointer 
so it can be looked up in the DHT, the name and size of the object referenced 
for interfaces to use, the key used to encrypt the pointer, and the key used 
to encrypt the object. </p>
<blockquote>
<p>Note that this link can be used by anyone to download the pointer, which 
allows anyone who is included in the object's access policy to download 
and decrypt the object itself. </p>
</blockquote>
<h3><code>PUT /</code></h3><p>To fetch an object pointer shared by someone else, you can send the magnet link
and get back an object pointer with an ID you can use in the download example.</p>
<pre class="prettyprint source"><code>curl -X PUT --data &quot;magnet:?xt=...&quot; http://127.0.0.1:4445</code></pre><blockquote>
<p>Protip! Pipe the output of the example above through 
<code>jq -r .href | xclip -selection clipboard</code> to copy the magnet link directly 
to your clipboard. ;)</p>
</blockquote>
<h3><code>DELETE /{id}</code></h3><p>You can destroy an object, nullifying associated contracts by sending a 
<code>DELETE /{id}</code> request.</p>
<pre class="prettyprint source"><code>$ curl -X &quot;DELETE&quot; http://127.0.0.1:4445/d049bff2-21b5-4f2f-bac3-efb3832a5afb</code></pre>
</article>

</section>

		</div>
	</div>

	<div class="clearfix"></div>

	

</div>
</div>

<div class="modal fade" id="searchResults">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Search results</h4>
      </div>
      <div class="modal-body"></div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div>

<footer>


	<span class="copyright">
	Copyright 2017 Counterpoint Hackerspace
	</span>

<span class="jsdoc-message">
	Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a>
	
	using the <a href="https://github.com/docstrap/docstrap">DocStrap template</a>.
</span>
</footer>

<script src="scripts/docstrap.lib.js"></script>
<script src="scripts/toc.js"></script>
<script type="text/javascript" src="scripts/fulltext-search-ui.js"></script>

<script>
$( function () {
	$( "[id*='$']" ).each( function () {
		var $this = $( this );

		$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
	} );

	$( ".tutorial-section pre, .readme-section pre" ).each( function () {
		var $this = $( this );

		var example = $this.find( "code" );
		exampleText = example.html();
		var lang = /{@lang (.*?)}/.exec( exampleText );
		if ( lang && lang[1] ) {
			exampleText = exampleText.replace( lang[0], "" );
			example.html( exampleText );
			lang = lang[1];
		} else {
			var langClassMatch = example.parent()[0].className.match(/lang\-(\S+)/);
			lang = langClassMatch ? langClassMatch[1] : "javascript";
		}

		if ( lang ) {

			$this
			.addClass( lang )
			.addClass( "linenums" )
			.html( example.html() );

		}
	} );

	$('pre').each(function(i, block) {
		hljs.highlightBlock(block);
	});

	$.catchAnchorLinks( {
        navbarOffset: 10
	} );
	$( "#toc" ).toc( {
		anchorName  : function ( i, heading, prefix ) {
			var id = $( heading ).attr( "id" );
			return id && id.replace(/\~/g, '-inner-').replace(/\./g, '-static-') || ( prefix + i );
		},
		selectors   : "#toc-content h1,#toc-content h2,#toc-content h3,#toc-content h4",
		showAndHide : false,
		smoothScrolling: true
	} );

	$( "#main span[id^='toc']" ).addClass( "toc-shim" );
	$( '.dropdown-toggle' ).dropdown();

    $( "table" ).each( function () {
      var $this = $( this );
      $this.addClass('table');
    } );

} );
</script>



<!--Navigation and Symbol Display-->


<!--Google Analytics-->


<script type="text/javascript">
	$(document).ready(function() {
		SearcherDisplay.init();
	});
</script>

</body>
</html>